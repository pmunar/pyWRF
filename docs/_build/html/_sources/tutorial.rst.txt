.. _tutorial:

Tutorial
========

In this tutorial we will cover the main steps to perform in order to analyze a small set of GDAS data.

We will assume that our working directory is under the /home/analysis/ path

It is assumed that we downloaded the GDAS data from 2012-01-01 until 2012-01-09 from the `UCAR download system <https://rda.ucar.edu/datasets/ds083.2/index.html#!cgi-bin/datasets/getSubset?dsnum=083.2&listAction=customize&_da=y&gindex=2>`__ by selecting all available parameters and a certain region of interest (we centered ours on the Canary islands, Spain).

Once we get the data, we will assume that we have stored it in the folder /home/wrf_analysis/data path

The outputs generated by the program are assumed to be in /home/analysis/ path

The first thing to do is to run the wrf_config script, in order to get a copy of the configuration file into the working directory.

.. code-block:: bash

    > wrf_config config_file.conf

Once we have the config file in the working directory we can open it with our favourite editor and edit its content.

For this case, we need to change the parameters in the Data section and in the Analysis section:

.. code-block:: bash

    [Data]

    data_path = /home/wrf_analysis/data
    output_path = /home/wrf_analysis/
    data_format = grib2

    [Analysis]

    start_date = "2012-01-01_00_00"
    end_date   = "2012-01-07_00_00"
    group_of_days = 5
    parallel = False
    tag = "My_analysis_test"

This way we told the program where our data is (data_path), where do we want the outputs (output_path), which is the format of the input GDAS files (data_format), the stard and end dates of the whole analysis (group_of_days)

Now we just need to run another command to start the analysis:

.. code-block:: bash

    > wrf_analysis config_file.conf

If you run the command like this, with no optional parameters, it will run all the PREPROCESSING and the WRF scripts. At the end, it will copy all the output files into the wps_out and wrf_out directories, under your working directory (/home/wrf_analysis/ in this case). If these directories do not exist, the program creates them.

The program, in this case, will take all the data and divide it into groups of 5 days (as specified by the group_of_days parameter), and analyze each group together. If the last group is shorter than the group_of_days parameter, the program simply takes the remaining data and analizes it.

If you want to run only a part of the program, e.g. the PREPROCESSING, you can call it like this:

.. code-block:: bash

    > wrf_analysis config_file.conf --wps

After completion, the outputs will not be moved to the output directory, since they might be needed for other parts of the analysis process.

In order to move all outputs into the working directory, you can do:

.. code-block:: bash

    > wrf_analysis config_file.conf --clean